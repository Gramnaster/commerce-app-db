json.status do
  json.code 200
  json.message "Users were retrieved successfully."
end

json.pagination @pagination if @pagination

json.data do
  json.users do
    @users.each do |user|
      json.set! user.id do
        json.id user.id
        json.email user.email
        json.is_verified user.is_verified
        json.confirmed_at user.confirmed_at
        json.created_at user.created_at
        json.updated_at user.updated_at

        if user.user_detail
          json.user_detail do
            json.first_name user.user_detail.first_name
            json.middle_name user.user_detail.middle_name
            json.last_name user.user_detail.last_name
            json.dob user.user_detail.dob
          end
        end

        json.phones do
          json.array! user.phones do |phone|
            json.id phone.id
            json.phone_no phone.phone_no
            json.phone_type phone.phone_type
          end
        end

        json.user_addresses do
          json.array! user.user_addresses do |user_address|
            json.id user_address.id
            json.is_default user_address.is_default
            if user_address.address
              json.address do
                json.id user_address.address.id
                json.unit_no user_address.address.unit_no
                json.street_no user_address.address.street_no
                json.address_line1 user_address.address.address_line1
                json.address_line2 user_address.address.address_line2
                json.barangay user_address.address.barangay
                json.city user_address.address.city
                json.region user_address.address.region
                json.zipcode user_address.address.zipcode
                json.country_id user_address.address.country_id
              end
            end
          end
        end

        json.user_payment_methods do
          json.array! user.user_payment_methods do |payment_method|
            json.id payment_method.id
            json.balance payment_method.balance
            json.payment_type payment_method.payment_type
          end
        end
      end
    end
  end
end
